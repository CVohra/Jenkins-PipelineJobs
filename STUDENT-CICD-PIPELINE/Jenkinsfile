node{
    stage('Cloning Repository') {
        git 'https://github.com/cit-agnitio/student-springboot.git'
    }

    stage('Compile Code') {
        try {
            withMaven(jdk: 'JDK8', maven: 'MAVEN354') {
                sh 'mvn compile'
            }
        }
        catch (exc) {
            slackSend color: '#FF0000', message: "Jenkins Job FAILURE\nJenkins Job NAME: ${env.JOB_NAME}\nJenkins Job URL: ${env.BUILD_URL}"
            sh 'false'
        }
    }

    stage('Code Analysis') {
        withMaven(jdk: 'JDK8', maven: 'MAVEN354') {
            sh 'mvn sonar:sonar -Dsonar.host.url=http://10.142.0.10:9000 -Dsonar.login=8210bc003804617f42e4bd097912c21ad0769a7d'
        }
    }

    stage('Packaging') {
        withMaven(jdk: 'JDK8', maven: 'MAVEN354') {
            sh 'mvn package'
        }
    }

    stage('Run Ansible Playbook') {
        git 'https://github.com/cit-agnitio/ansible-playbooks-testing.git'
        

        //sh 'ansible-playbook -i /tmp/inventory single-node-stack.yml'
    }
}
